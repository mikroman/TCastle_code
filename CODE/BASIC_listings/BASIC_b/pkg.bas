8103 data 8,66,69,84,32,83,73,90,69,5,100,15,250,25,500
8149 clr:dimcr(52):dimdp(51):dimmi(2):dimma(2):dimhd(4):dimcs(13):dimst(4):dimct(4)
8210 dimkp(4):ba=36864
8211 ve=(ba+(18*3)):readcl:x1=1:forx1=x1tocl:readi:cd$=(cd$+chr$(i)):next
8248 v1=(peek(ve)+(peek((ve+1))*256)):v2=(peek((ve+2))+(peek((ve+3))*256))
8274 v3=(peek((ve+4))+(peek((ve+5))*256)):v4=(peek((ve+6))+(peek((ve+7))*256))
8302 v5=(peek((ve+8))+(peek((ve+9))*256))
8316 x1=0:forx1=x1to2:readmi(x1):readma(x1):next
8331 sys(ba):jo=56320:gosub9048:gosub9166:gosub9285:gosub8915:gosub9111
8356 ifpeek(v3)then:gosub8741
8363 ifflthen:fl=0:goto9844
8371 geta$
8373 p=peek(v4)
8376 b=(peek(jo)and16)
8381 if(((p=0)and(a$=""))and(b=16))then8356
8395 ifpthen:gosub8741:goto8356
8404 ifpeek(v3)then8356
8409 if(b=0)then:gosub8490
8417 if(a$="")then8356
8423 if((peek(653)and4)=0)then8477
8434 if(asc(a$)=17)then10435
8441 if(asc(a$)=2)then:gosub8772
8450 if(asc(a$)=19)then:gosub8808
8459 if(asc(a$)=22)then:gosub10763
8468 if(asc(a$)=15)then:gosub10018
8477 if(asc(a$)=63)then:gosub10486
8487 goto9334
8490 gosub8705
8493 if((y1<120)or(y1>134))then8610
8505 x1=(x1+8)
8509 if(((x1<60)or(x1>259))or(f1=0))thenreturn
8524 x=int(((x1-60)/40))
8533 poke163,(32+(x*20))
8542 poke164,72
8547 poke249,((52*(1-kp(x)))+(kp(x)*hd(x)))
8566 sys((ba+(12*3)))
8573 poke164,128
8578 poke2,(1-kp(x))
8585 sys((ba+(13*3)))
8592 kp(x)=(1-kp(x))
8600 x=1
8602 forx=xto500
8608 next
8609 return
8610 if((((x1<11)or(x1>96))or(y1<155))or(y1>179))thenreturn
8629 if(f1=0)then8808
8635 i=0
8637 fori=ito4
8641 if(kp(i)=0)then8701
8649 poke163,(32+(i*20))
8658 poke164,72
8663 poke249,cr(cu)
8669 sys((ba+(17*3)))
8676 poke164,128
8681 poke2,0
8684 sys((ba+(13*3)))
8691 hd(i)=cr(cu)
8697 cu=(cu+1)
8701 next
8702 fl=1
8704 return
8705 x1=((peek(53248)-24)+((peek(53264)and1)*256))
8729 y1=(peek(53249)-50)
8740 return
8741 waitv3,1
8744 gosub8705
8747 if(((((x1<240)or(x1>272))or(y1<35))or(y1>55))orf1)then8802
8772 if((tb=>(5*be))or(((ub-tb)-be)<0))then8802
8788 sys((ba+(15*3)))
8795 tb=(tb+be)
8799 gosub8943
8802 pokev3,0
8805 goto9111
8808 if(tb=0)then9239
8814 iff1then8635
8818 i=0
8820 fori=ito4
8824 poke163,(32+(i*20))
8833 poke164,72
8838 poke249,cr((cu+i))
8846 sys((ba+(17*3)))
8853 hd(i)=cr((cu+i))
8861 kp(i)=0
8865 next
8866 f1=1
8868 cu=6
8870 return
8871 poke164,0
8875 poke2,16
8878 gosub9003
8881 print"{clr}{blk}";
8885 printtab(z)
8887 prints$
8889 i=0
8891 fori=ito39
8896 poke(v2+i),peek((1024+i))
8906 next
8907 sys((ba+(9*3)))
8914 return
8915 gosub8974
8918 poke2,16
8921 s$="current bet: $"
8938 z=0
8940 gosub8871
8943 s$=""
8945 gosub10843
8948 s$=(s$+"{$a0}{$a0}{$a0}")
8955 if(len(s$)<5)then:s$=("0"+s$):goto8955
8969 z=14
8971 goto8871
8974 i=0
8976 fori=ito39
8981 poke(v2+i),96
8987 next
8988 poke164,0
8992 poke2,16
8995 sys((ba+(9*3)))
9002 return
9003 i=0
9005 fori=ito39
9010 poke(v2+i),32
9016 next
9017 return
9018 mo=ub
9020 gosub9136
9023 i=1
9025 fori=ito9
9029 poke(680+i),asc(mid$(m$,i,1))
9040 next
9041 poke690,255
9047 return
9048 s$=""
9050 i=1
9052 fori=ito9
9056 s$=(s$+chr$(peek((680+i))))
9066 next
9067 ub=val(s$)
9070 li=peek(680)
9075 be=peek(700)
9080 co=(peek(53289)and15)
9090 poke36197,(co*16)
9100 poke36198,(co*16)
9110 return
9111 mo=(ub-tb)
9115 k=1
9117 if(mo>0)then:k=5
9124 poke165,k
9128 sys((ba+(14*3)))
9135 return
9136 m$=str$(ub)
9139 l=(len(m$)-1)
9144 m$=right$(m$,l)
9148 if(l<9)then:m$=("0"+m$):l=(l+1):goto9148
9165 return
9166 gosub9136
9169 i=0
9171 fori=ito8
9175 poke(v1+i),val(mid$(m$,(i+1),1))
9186 next
9187 sys((ba+(5*3)))
9194 return
9195 k=0
9197 ifbethen:k=7
9202 if(be=5)then:k=13
9209 poke53288,k
9217 return
9218 be=0
9220 co=peek(165)
9224 if(co=7)then:be=1
9231 if(co=13)then:be=5
9238 return
9239 gosub8974
9242 s$="you must insert a coin !!!"
9271 z=((40-len(s$))/2)
9279 gosub8871
9282 goto10399
9285 x=rnd(-rnd(0))
9290 i=0
9292 fori=ito51
9297 dp(i)=0
9301 next
9302 i=1
9304 fori=ito52
9309 j=int((rnd(1)*52))
9316 ifdp(j)then9309
9322 cr(i)=j
9326 dp(j)=1
9330 next
9331 cu=1
9333 return
9334 t$=right$((t$+a$),cl)
9342 if(t$<>cd$)then8356
9349 sys((ba+3))
9354 sys((ba+9))
9359 print"{clr}{yel}"
9363 poke53269,0
9371 printtab(13)
9373 print"{down}{down}{down}{down}{red}change bet size"
9396 print
9397 print"{pur}enter new bet size:"
9420 print"{yel}==>{blu}C{left}";
9429 s$=""
9431 geta$
9433 if(a$<>chr$(13))then:if(a$<>chr$(20))then:if((a$<"0")or(a$>"9"))then9431
9457 if(a$=chr$(13))then9513
9464 if((a$=chr$(20))and(s$<>""))then:print" {left}{left}C{left}";:s$=left$(s$,(len(s$)-1))
9488 if((a$=chr$(20))or(len(s$)>3))then9431
9500 printa$;
9502 print"C{left}";
9506 s$=(s$+a$)
9510 goto9431
9513 be=val(s$)
9516 print"{clr}"
9519 sys((ba+6))
9524 gosub9111
9527 sys(ba)
9530 goto8356
9533 i=0
9535 fori=ito12
9539 cs(i)=0
9543 next
9544 i=0
9546 fori=ito4
9550 st(i)=int((hd(i)/13))
9559 ct(i)=(hd(i)-(13*st(i)))
9571 cs(ct(i))=(cs(ct(i))+1)
9583 next
9584 fl=0
9586 if((((st(0)=st(1))and(st(1)=st(2)))and(st(2)=st(3)))and(st(3)=st(4)))then:fl=4
9621 sr=0
9624 cs(13)=cs(0)
9630 i=1
9632 fori=ito9
9636 if((((cs(i)andcs((i+1)))andcs((i+2)))andcs((i+3)))andcs((i+4)))then:sr=1
9668 next
9669 j=0
9671 k=0
9673 i=0
9675 fori=ito12
9679 if(cs(i)>1)then:k=(-2*(j<>0)):j=cs(i)
9697 next
9698 i=0
9700 if(((flandsr)andcs(0))andcs(12))then:i=250:goto9834
9720 if(flandsr)then:i=50:goto9834
9732 if(j=4)then:i=25:goto9834
9742 if((j=3)and(k=2))then:i=9:goto9834
9756 ifflthen:i=6:goto9834
9764 ifsrthen:i=4:goto9834
9773 if(j=3)then:i=3:goto9834
9783 if((j=2)and(k=2))then:i=2:goto9834
9797 if(j=0)then9834
9803 j=0
9805 forj=jto12
9809 if(cs(j)=2)then:k=j:j=12
9820 next
9821 i=1
9823 if((k<>0)and(k<10))then:i=0
9834 j=0
9836 k=0
9838 fl=0
9840 sr=0
9843 return
9844 gosub9533
9847 am=(tb*i)
9852 if(am=0)then:am=-tb
9862 if(am>0)then:poke2,(((am/16)+1)and255):sys((ba+(16*3)))
9886 ub=int((ub+am))
9892 gosub9166
9895 s$="{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}"
9918 z=20
9920 gosub8871
9923 s$="won  $"
9931 if(am<0)then:s$="lost $"
9945 tb=am
9948 gosub10843
9951 tb=0
9953 if(len(s$)<10)then:s$=(s$+" "):goto9953
9967 z=30
9969 gosub8871
9972 rf=1
9975 gosub10399
9978 i=0
9980 fori=ito4
9984 poke163,(32+(i*20))
9993 poke164,72
9998 sys((ba+21))
10003 next
10004 gosub9285
10007 gosub9111
10010 f1=0
10012 gosub8943
10015 goto8356
10018 sys((ba+3))
10023 print"{clr}{yel}"
10027 sys((ba+9))
10032 poke53269,0
10040 print"hand";
10046 printtab(30)
10048 print"payoff"
10056 print"-------------";
10072 printtab(30)
10074 print"---------"
10086 print"royal flush";
10100 printtab(30)
10102 print"250 times"
10114 print"straight flush";
10131 printtab(31)
10133 print"50 times"
10144 print"four of a kind";
10161 printtab(31)
10163 print"25 times"
10174 print"full house";
10187 printtab(32)
10190 print"9 times"
10199 print"flush";
10206 printtab(32)
10209 print"6 times"
10218 print"straight";
10229 printtab(32)
10232 print"4 times"
10241 print"three of a kind";
10259 printtab(32)
10262 print"3 times"
10271 print"two pair";
10282 printtab(32)
10285 print"2 times"
10294 print"one pair (jacks or better)";
10323 printtab(32)
10326 print"1 times"
10335 iff1then:gosub9533:print"{down}{down}current hand pays $";
10365 iff1then:s$=str$((tb*i)):l=len(s$):printright$(s$,(l-1))
10382 rf=1
10385 gosub10399
10388 sys((ba+6))
10393 sys(ba)
10396 goto9111
10399 if((peek(jo)and31)=31)then:if(peek(198)=0)then10399
10415 geta$
10417 a$=" "
10420 poke198,0
10424 ifrfthen:rf=0:return
10432 goto8915
10435 gosub8974
10438 sys((ba+3))
10443 poke53269,0
10451 poke53280,0
10459 poke53281,0
10467 sys((ba+9))
10472 gosub9018
10475 print"{blk}{clr}"
10479 load"cml",8
10486 sys((ba+3))
10491 sys((ba+9))
10496 print"{clr}{yel}"
10500 poke53269,0
10508 printtab(14)
10510 print"{down}{down}{down}{down}{down}{down}{down}help screen"
10531 print
10532 printtab(4)
10534 print"ctrl-v      show bet size"
10562 printtab(4)
10564 print"ctrl-o      show payoffs"
10591 printtab(4)
10593 print"ctrl-b      insert coin"
10619 printtab(4)
10621 print"ctrl-s      deal"
10640 printtab(4)
10642 print"ctrl-q      quit game"
10666 print
10667 printtab(4)
10669 print"   ?        show this menu"
10698 print"{down}{down}{down}{down}{down}{rght}hit any key or move joystick to return"
10745 gosub10399
10748 print"{clr}"
10751 sys((ba+6))
10756 gosub9111
10759 sys(ba)
10762 return
10763 if(peek(53278)=0)then10805
10775 s$="chip size is: $"
10793 z=tb
10795 tb=be
10797 gosub10843
10800 tb=z
10802 goto10825
10805 s$="bet size is: $"
10822 gosub10843
10825 gosub8974
10828 z=int(((40-len(s$))/2))
10837 gosub8871
10840 goto10399
10843 o$=str$(int(tb))
10848 l=(len(o$)-1)
10854 o$=right$(o$,l)
10860 s$=(s$+o$)
10865 return