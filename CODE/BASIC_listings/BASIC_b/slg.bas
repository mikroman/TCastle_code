8103 data8,66,69,84,32,83,73,90,69,5,100,15,250,25,500:clr
8152 dimmi(2):dimma(2):dimjk(3):dimpy(4,4):dimwi(4):ba=28672:ve=(ba+(17*3))
8198 readcl:x1=1:forx1=x1tocl:readi:cd$=(cd$+chr$(i)):next
8216 v1=(peek(ve)+(peek((ve+1))*256)):v2=(peek((ve+2))+(peek((ve+3))*256))
8242 v3=(peek((ve+4))+(peek((ve+5))*256)):v4=(peek((ve+6))+(peek((ve+7))*256))
8270 v5=(peek((ve+8))+(peek((ve+9))*256)):v6=(peek((ve+10))+(peek((ve+11))*256))
8300 forx1=0to2:readmi(x1):readma(x1):next
8313 gosub9119:gosub9310:sys(ba):jo=56320:gosub9248:gosub8790:cn=0
8337 ifpeek(v5)then:gosub8574
8344 ifflthen:fl=0:gosub8663
8352 geta$
8354 p=peek((v5+1))
8359 b=(peek(jo)and16)
8364 if(((p=0)and(a$=""))and(b=16))then8337
8378 ifpthen:gosub8574:goto8337
8387 ifpeek(v5)then8337
8392 if(b=0)then:gosub8473
8400 if(a$="")then8337
8406 if((peek(653)and4)=0)then8460
8417 if(asc(a$)=17)then11494
8424 if(asc(a$)=2)then:gosub8591
8433 if(asc(a$)=19)then:gosub8663
8442 if(asc(a$)=22)then:gosub11846
8451 if(asc(a$)=15)then:gosub11351
8460 if(asc(a$)=63)then:gosub11542
8470 goto9431
8473 gosub8538
8476 if(((mc=3)or(mc=6))or(mc=9))then8514
8490 if((((x1<216)or(x1>270))or(y1<64))or(y1>151))thenreturn
8511 goto8663
8514 if((((x1<240)or(x1>286))or(y1<56))or(y1>143))thenreturn
8535 goto8663
8538 x1=((peek(53248)-24)+((peek(53264)and1)*256))
8562 y1=(peek(53249)-50)
8573 return
8574 waitv5,1
8577 if((peek(53288)and15)=0)then8645
8591 if(((tb>(4*be))or(((ub-tb)-be)<0))or(((mc/3)=int((mc/3)))and(tb>(2*be))))then8645
8622 sys((ba+(10*3)))
8629 tb=(tb+be)
8633 cn=(cn+1)
8637 poke2,cn
8640 sys((ba+24))
8645 pokev5,0
8648 x=1
8650 forx=xto500
8656 next
8657 gosub9248
8660 goto8818
8663 if(tb=0)then9385
8669 sys((ba+21))
8674 i=0
8676 fori=ito(cn-1)
8682 x=0
8684 forx=xto4
8688 py(i,x)=peek(((v3+(i*5))+x))
8700 next
8701 next
8702 if(cn>3)then:i=0:fori=ito2:py(3,i)=py(i,i):next
8722 if(cn>4)then:i=0:fori=ito2:py(4,i)=py((2-i),i):next
8744 goto11116
8747 poke164,0
8751 poke2,16
8754 gosub8868
8757 print"{home}";
8760 printtab(z)
8762 prints$
8764 i=0
8766 fori=ito39
8771 poke(v6+i),peek((1024+i))
8781 next
8782 sys((ba+(14*3)))
8789 return
8790 gosub8839
8793 poke2,16
8796 s$="current bet: $"
8813 z=0
8815 gosub8747
8818 s$=""
8820 tb=(be*cn)
8824 gosub11915
8827 s$=(s$+"{$a0}{$a0}{$a0}")
8834 z=14
8836 goto8747
8839 i=0
8841 fori=ito39
8846 poke(v6+i),96
8852 next
8853 poke164,0
8857 poke2,16
8860 sys((ba+(14*3)))
8867 return
8868 i=0
8870 fori=ito39
8875 poke(v6+i),32
8881 poke(1024+i),32
8889 next
8890 return
8891 open15,8,15
8896 cmd15,;
8898 print#15,"s0:progs"
8909 open2,8,2,"progs,s,w"
8925 input#15,e,er$
8932 if(e>19)then8985
8938 i=1
8940 fori=ito3
8944 cmd2,;
8946 print#2,jk(i)
8950 next
8951 close2
8953 close15
8955 o=ub
8957 gosub9275
8960 i=1
8962 fori=ito9
8966 poke(680+i),asc(mid$(m$,i,1))
8977 next
8978 poke690,255
8984 return
8985 print"{down}{down}{down}{red}error -- ";
9001 printstr$(e);
9004 print"    ";
9010 printer$
9012 print"trying to create file 'progs'"
9044 print"please correct as necessary and hit"
9082 print"return to continue"
9103 geta$
9105 if(a$<>chr$(13))then9103
9112 close2
9114 close15
9116 goto8891
9119 s$=""
9121 i=1
9123 fori=ito9
9127 s$=(s$+chr$(peek((680+i))))
9137 next
9138 ub=val(s$)
9141 li=peek(680)
9146 be=peek(700)
9151 co=(peek(53289)and15)
9161 mc=peek(690)
9166 open15,8,15
9171 open2,8,2,"progs,s,r"
9187 input#15,e
9192 if(e>19)then:i=1:fori=ito3:jk(i)=100:next:goto9225
9212 i=1
9214 fori=ito3
9218 input#2,jk(i)
9224 next
9225 close2
9227 close15
9229 jk=((mc+1)/3)
9236 if(jk<>int(jk))then:jk=0
9247 return
9248 mo=(ub-tb)
9253 k=1
9256 if(mo>0)then:k=5
9265 poke53269,k
9274 return
9275 m$=str$(o)
9278 l=(len(m$)-1)
9284 m$=right$(m$,l)
9289 if(l<9)then:m$=("0"+m$):l=(l+1):goto9289
9309 return
9310 o=ub
9312 gosub9275
9315 i=0
9317 fori=ito8
9321 poke(v1+i),val(mid$(m$,(i+1),1))
9332 next
9333 pokev4,0
9336 sys((ba+(5*3)))
9343 if(jk=0)thenreturn
9348 o=jk(jk)
9353 gosub9275
9356 i=0
9358 fori=ito8
9362 poke(v1+i),val(mid$(m$,(i+1),1))
9373 next
9374 pokev4,1
9377 sys((ba+(5*3)))
9384 return
9385 gosub8839
9388 s$="you must insert a coin !!!"
9417 z=((40-len(s$))/2)
9425 gosub8747
9428 goto11458
9431 t$=right$((t$+a$),cl)
9439 if(t$<>cd$)then8337
9446 sys((ba+36))
9452 sys((ba+3))
9457 sys((ba+9))
9462 print"{clr}{yel}"
9466 poke53269,0
9474 printtab(13)
9476 print"{down}{down}{down}{down}{red}change bet size"
9499 print
9500 print"{pur}enter new bet size:"
9523 print"{yel}==>{blu}C{left}";
9532 s$=""
9534 geta$
9536 if(a$<>chr$(13))then:if(a$<>chr$(20))then:if((a$<"0")or(a$>"9"))then9534
9560 if(a$=chr$(13))then9616
9567 if((a$=chr$(20))and(s$<>""))then:print" {left}{left}C{left}";:s$=left$(s$,(len(s$)-1))
9591 if((a$=chr$(20))or(len(s$)>3))then9534
9603 printa$;
9605 print"C{left}";
9609 s$=(s$+a$)
9613 goto9534
9616 be=val(s$)
9619 print"{clr}"
9622 sys((ba+39))
9628 sys((ba+6))
9633 gosub9248
9636 sys(ba)
9639 goto8337
9642 j=0
9645 wf=0
9648 i=0
9650 fori=ito(cn-1)
9656 k=-1
9660 am=0
9663 wi(i)=0
9667 if(mc<>4)then9865
9673 if(py(i,0)=14)then:k=1
9684 if(py(i,0)=12)then:if(py(i,1)=14)then:k=1
9703 if(py(i,0)=13)then:if(py(i,1)=14)then:k=1
9722 if(py(i,0)=12)then:if(py(i,1)=12)then:k=1
9741 if(py(i,0)=13)then:if(py(i,1)=14)then:if(py(i,2)=13)then:k=20
9768 if(py(i,0)=12)then:if(py(i,1)=14)then:if(py(i,2)=14)then:k=30
9795 if(py(i,0)=py(i,1))then:if(py(i,1)=py(i,2))then:if(py(i,2)=13)then:k=8
9828 if(py(i,0)=py(i,1))then:if(py(i,1)=py(i,2))then:if(py(i,2)=12)then:k=40
9862 goto11070
9865 if(mc<>9)then10103
9871 if(py(i,0)=10)then:if(py(i,1)=5)then:if(py(i,2)=10)then:k=1
9898 if(py(i,0)=5)then:if(py(i,1)=10)then:k=1
9917 if(py(i,0)=11)then:if(py(i,1)=11)then:k=1
9936 if(py(i,0)=5)then:if(py(i,1)=5)then:if(py(i,2)=5)then:k=1
9963 if(py(i,0)=10)then:if(py(i,1)=10)then:k=10
9982 if(((((py(i,0)=10)and(py(i,1)=10))and(py(i,2)=10))and(py(i,3)=10))and(py(i,4)=10))then:k=15
10021 if(((((py(i,0)=11)and(py(i,1)=11))and(py(i,2)=11))and(py(i,3)=11))and(py(i,4)=11))then:k=10
10060 if(((((py(i,0)=5)and(py(i,1)=5))and(py(i,2)=5))and(py(i,3)=5))and(py(i,4)=5))then:k=40
10100 goto11070
10103 if((mc<>6)and(mc<>3))then10482
10113 if(py(i,0)=0)then:if(py(i,1)=0)then:k=2
10132 if(py(i,0)=5)then:if(py(i,1)=5)then:if(py(i,2)=5)then:k=3
10159 if(py(i,0)=7)then:if(py(i,1)=4)then:k=7
10178 if(py(i,0)=2)then:if(py(i,1)=5)then:k=12
10197 if(py(i,0)=15)then:if(py(i,1)=5)then:k=12
10216 if(py(i,0)=7)then:if(py(i,1)=7)then:if(py(i,2)=1)then:k=175
10244 if(py(i,0)=2)then:if(py(i,1)=2)then:if(py(i,2)=5)then:k=175
10272 if(py(i,0)=15)then:if(py(i,1)=15)then:if(py(i,2)=5)then:k=175
10300 if(py(i,0)=3)then:if(py(i,1)=3)then:if(py(i,2)=3)then:k=200
10328 if(py(i,0)=7)then:if(py(i,1)=7)then:if(py(i,2)=7)then:k=220
10356 if(((((py(i,0)=5)and(py(i,1)=5))and(py(i,2)=5))and(py(i,3)=5))and(py(i,4)=5))then:k=450
10397 if(((((py(i,0)=2)and(py(i,1)=2))and(py(i,2)=2))and(py(i,3)=2))and(py(i,4)=2))then:k=500
10438 if(((((py(i,0)=15)and(py(i,1)=15))and(py(i,2)=15))and(py(i,3)=15))and(py(i,4)=15))then:k=500
10479 goto11070
10482 if((mc<>5)and(mc>2))then10793
10492 if(py(i,0)=0)then:if(py(i,1)=0)then:k=4
10511 if(py(i,0)=6)then:k=2
10522 if(py(i,0)=1)then:if(py(i,1)=4)then:k=6
10541 if(py(i,0)=3)then:if(py(i,1)=5)then:k=6
10560 if(py(i,0)=7)then:if(py(i,1)=7)then:k=7
10579 if(py(i,0)=8)then:if(py(i,1)=8)then:k=8
10598 if(py(i,0)=py(i,1))then:if(py(i,1)=py(i,2))then:if(py(i,2)=6)then:k=150
10632 if(py(i,0)=py(i,1))then:if(py(i,1)=py(i,2))then:if(py(i,2)=7)then:k=200
10666 if(py(i,0)=py(i,1))then:if(py(i,1)=py(i,2))then:if(py(i,2)=2)then:am=jk(jk):k=250
10706 if(py(i,0)=py(i,1))then:if(py(i,1)=py(i,2))then:if(py(i,2)=15)then:am=jk(jk)
10742 if(py(i,0)=py(i,1))then:if(py(i,1)=py(i,2))then:if(py(i,2)=5)then:am=jk(jk):k=200
10782 if(mc=1)then:am=0
10790 goto11070
10793 if(py(i,0)=10)then:if(py(i,1)=10)then:if(py(i,2)=5)then:k=2
10820 if(py(i,0)=11)then:if(py(i,1)=10)then:k=2
10839 if(py(i,0)=10)then:if(py(i,1)=5)then:if(py(i,2)=10)then:k=3
10866 if(py(i,0)=5)then:if(py(i,1)=10)then:if(py(i,2)=10)then:k=3
10893 if(py(i,0)=10)then:if(py(i,1)=5)then:if(py(i,2)=11)then:k=3
10920 if(py(i,0)=5)then:if(py(i,1)=5)then:if(py(i,2)=10)then:k=7
10947 if(py(i,0)=5)then:if(py(i,1)=5)then:if(py(i,2)=11)then:k=8
10974 if(py(i,0)=10)then:if(py(i,1)=10)then:if(py(i,2)=10)then:k=7
11001 if(py(i,0)=11)then:if(py(i,1)=11)then:if(py(i,2)=11)then:k=4
11028 if(py(i,0)=5)then:if(py(i,1)=5)then:if(py(i,2)=5)then:k=100:am=jk(jk)
11062 if(mc=7)then:am=0
11070 if(amor(k>0))then:wi(i)=1:wf=1
11086 ifamthen:j=(j+am):jk(jk)=0:goto11114
11105 j=(j+(be*k))
11114 next
11115 return
11116 gosub9642
11119 am=j
11123 ifwfthen:poke2,((abs((am/16))+1)and255):sys((ba+27))
11144 ifjkthen:jk(jk)=(jk(jk)+int(((cn*be)/6)))
11163 gosub11266
11166 ub=int((ub+am))
11172 gosub9310
11175 s$="{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}{$a0}"
11188 z=30
11190 gosub8747
11193 s$="won  $"
11201 if(am<0)then:s$="lost $"
11215 if(am=0)then:s$="even":goto11236
11230 tb=am
11233 gosub11915
11236 z=30
11238 gosub8747
11241 i=1
11243 fori=itocn
11247 poke2,i
11250 sys((ba+24))
11255 next
11256 cn=0
11258 tb=0
11260 gosub8818
11263 goto9248
11266 if(wf=0)thenreturn
11271 x=1
11273 forx=xto5
11277 i=0
11279 fori=ito(cn-1)
11285 if(wi(i)=0)then11303
11293 poke2,(i+1)
11298 sys((ba+24))
11303 next
11304 y=1
11307 fory=yto200
11312 next
11313 i=0
11315 fori=ito(cn-1)
11321 if(wi(i)=0)then11339
11329 poke2,(i+1)
11334 sys((ba+24))
11339 next
11340 y=1
11343 fory=yto200
11348 next
11349 next
11350 return
11351 sys((ba+3))
11356 sys((ba+36))
11362 print"{yel}{clr}"
11366 poke2,mc
11369 sys((ba+33))
11375 print"{home}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{down}{rght}{rght}{rght}{rght}hit any key or move joystick ..."
11435 rf=1
11438 gosub11458
11441 sys((ba+39))
11447 sys((ba+6))
11452 sys(ba)
11455 goto9248
11458 if((peek(jo)and31)=31)then:if(peek(198)=0)then11458
11474 geta$
11476 a$=" "
11479 poke198,0
11483 ifrfthen:rf=0:return
11491 goto8790
11494 sys((ba+3))
11499 poke53269,0
11507 poke53280,0
11515 poke53281,0
11523 sys((ba+9))
11528 print"{blk}{clr}"
11532 gosub8891
11535 load"cml",8
11542 sys((ba+36))
11548 sys((ba+3))
11553 sys((ba+9))
11558 print"{clr}{yel}"
11562 poke53269,0
11570 printtab(14)
11572 print"{down}{down}{down}{down}{down}{down}{down}help screen"
11593 print
11594 printtab(4)
11596 print"ctrl-v      show bet/chip size"
11629 printtab(4)
11631 print"ctrl-o      show payoffs"
11658 printtab(4)
11660 print"ctrl-b      insert coin"
11686 printtab(4)
11688 print"ctrl-s      pull handle"
11714 printtab(4)
11716 print"ctrl-q      quit game"
11740 print
11741 printtab(4)
11743 print"   ?        show this menu"
11772 print"{down}{down}{down}{down}{down}{rght}hit any key or move joystick to return"
11819 rf=1
11822 gosub11458
11825 print"{clr}"
11828 sys((ba+39))
11834 sys((ba+6))
11839 gosub9248
11842 sys(ba)
11845 return
11846 gosub8839
11849 k=tb
11852 s$="chip{$a0}size{$a0}is:{$a0}$"
11870 tb=be
11872 gosub11915
11875 z=0
11877 gosub8747
11880 tb=k
11883 s$="bet{$a0}size{$a0}is:{$a0}$"
11900 gosub11915
11903 z=(40-len(s$))
11909 gosub8747
11912 goto11458
11915 o$=str$(int(tb))
11920 l=(len(o$)-1)
11927 o$=right$(o$,l)
11934 s$=(s$+o$)
11939 return