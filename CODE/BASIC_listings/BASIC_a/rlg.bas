8103 data15,65,76,80,72,65,32,68,69,76,84,65,32,80,72,73,6,77,65,88,66,69,84,5
8104 data100,15,250,25,500,1,2,2,2,2,1,2,2,2,3,2,2,2,2,1,2,2,2,1,5,50,100,500
8105 data120,129,138,147,156,15,21,26,31,35,40,44,49,53,59,64,69,73,78,82,87
8106 data91,97,102,107,111,116,120,125,129,0,140,0,0,41,41,41,41,41,41,41,0,78
8107 data78,78,78,78,78,78,0,115,115,115,115,115,115,115,0,0,0,0,33,33,33,33
8108 data51,51,51,0,68,68,68,0,87,87,87,0,105,105,105,123,123,123,123,0,0,50
8109 data75,75,75,98,122,122,122,145,0,0,50,66,82,98,98,98,114,130,145,158,174
8110 data0,66,0,98,98,98,0,130,0,0,0,-1,170,-1,171,171,171,-1,172,-1,-1,-1,-1
8111 data-1,3,3,3,3,3,3,3,-1,4,4,4,4,4,4,4,-1,5,5,5,5,5,5,5,-1,-1,6,6,6,6,7,7
8112 data7,-1,8,8,8,-1,9,9,9,-1,10,10,10,11,11,11,11,182,0,0,0,183,1,1,1,184
8767 clr:dimx(28,3):dimy(2,11):dimbu(28,12):dimbe(28,12):dimsz(5):dimpy(28,12)
8768 dimbl(35):dimfi(5):dimmi(2):dimma(2):dimre(20):tb=0:po=0:ba=28672
8769 ve=(ba+(20*3)):readcl:x1=1:forx1=x1tocl:readx:cd$=(cd$+chr$(x)):next:readc2
8888 x1=1:forx1=x1toc2:readx:c2$=(c2$+chr$(x)):next:x1=0:forx1=x1to2:readmi(x1)
8889 readma(x1):next:v1=(peek(ve)+(peek((ve+1))*256))
8890 v2=(peek((ve+2))+(peek((ve+3))*256)):v1=((v1-49152)/64)
8956 v3=(peek((ve+4))+(peek((ve+5))*256)):v4=(peek((ve+6))+(peek((ve+7))*256))
8984 v5=(peek((ve+8))+(peek((ve+9))*256)):r1=0:r2=0:gosub10888:x1=0
9007 ready1:x1=(x1+y1):bl(x1)=1:if(x1<34)then9007
9025 x1=1:forx1=x1to5:readsz(x1):next:x1=1:forx1=x1to5:readfi(x1):next:x1=0
9049 forx1=x1to28:x(x1,0)=0:bu(x1,0)=-1:bu(x1,12)=-1:y1=0
9072 fory1=y1to12:be(x1,y1)=0:next:next:y1=0
9085 fory1=y1to10:y(0,y1)=0:y(1,y1)=0:y(2,y1)=0:if(y1<4)then:x(0,y1)=0:x(28,y1)=0
9119 bu(0,y1)=-1:bu(28,y1)=-1:bu(26,y1)=-1:next:i=0:fori=ito4:poke(53242+i),(v1+i):next
9157 y1=1:fory1=y1to3:x1=1:forx1=x1to27:readx(x1,y1):next:next
9176 x1=0:forx1=x1to2:y1=1:fory1=y1to11:ready(x1,y1):next:next
9195 poke53262,((21*2)+22):poke53263,99:y1=1
9218 fory1=y1to4:x1=2:forx1=x1to25:bu(x1,y1)=((24*(y1-1))+x1):next:next
9241 y1=5:fory1=y1to6:x1=2:forx1=x1to25:bu(x1,y1)=bu(x1,4):next:next
9263 y1=7:fory1=y1to9:x1=2:forx1=x1to25:bu(x1,y1)=((24*(y1-3))+x1):next:next
9288 y1=1:fory1=y1to11:readbu(27,y1):next
9300 y1=10:fory1=y1to11:x1=1:forx1=x1to25:reada:if(a>0)then:a=(a+170)
9325 bu(x1,y1)=a:next:next:y1=1
9334 fory1=y1to9:readbu(1,y1):next:gosub10665:gosub10854:gosub10610:gosub10527:gosub10694
9359 p3=peek((v4+1)):p2=(peek(56320)and16):ifpeek(v4)then:gosub9848:goto9359
9384 ifp2then:if(p3=0)then:if(peek(198)=0)then9359
9400 ifp3then:gosub9832:goto9359
9409 if(p2=0)then:gosub9513:goto9359
9420 geta$:if(a$="")then9359
9428 if((peek(653)and4)=0)then9500
9439 if(asc(a$)=18)then:gosub13496
9448 if(asc(a$)=17)then12872
9455 if(asc(a$)=19)then:gosub9887
9464 if(asc(a$)=22)then:gosub13384
9473 if(asc(a$)=15)then:gosub12472
9482 if(asc(a$)=12)then:gosub12928
9491 if(asc(a$)=8)then:gosub12376
9500 if(asc(a$)=63)then:gosub12998
9510 goto11253
9513 ifpeek((v4+1))thenreturn
9518 sys((ba+21))
9523 gosub9682
9526 gosub10340
9529 if(be(x,y)=0)then9593
9538 ifpeek(v4)thenreturn
9541 gosub10128
9544 if(be=0)thenreturn
9548 tb=(tb-be)
9552 if(peek(56320)and16)then10567
9564 gosub11155
9567 sys((ba+(17*3)))
9574 poke53269,(peek(53269)or2)
9590 goto10567
9593 if(((y1<3)or(x1>37))or(y1>44))then:wait56320,16:return
9617 goto9887
9620 if((x=2)and(y=1))then:poke53269,(peek(53269)and127):return
9647 bu=bu(x,y)
9652 x1=x(x,y8)
9657 y1=y(x8,y)
9662 goto9665
9665 poke163,x1
9669 poke164,y1
9673 poke2,bu
9676 sys((ba+30))
9681 return
9682 x1=(((peek(53248)-24)+((peek(53264)and1)*256))/2)
9708 y1=(peek(53249)-50)
9719 x=peek(163)
9723 y=peek(164)
9727 return
9728 if((x<>2)or(y<>1))then9772
9738 poke53247,peek(53241)
9752 poke53269,(peek(53269)or128)
9769 goto9802
9772 x1=((x(x,y8)*2)+22)
9781 y1=y(x8,y)
9786 gosub10948
9789 x2=x(x,y8)
9794 y2=y(x8,y)
9799 gosub10934
9802 be(x,y)=(be(x,y)+be)
9812 tb=(tb+be)
9816 be=0
9818 gosub10694
9821 pokev4,0
9824 goto10567
9827 be=0
9829 goto9812
9832 if(peek((v4+1))=0)then:if(peek(v4)=0)thenreturn
9845 waitv4,1
9848 gosub9682
9851 bu=bu(x,y)
9856 if(bu<0)then9827
9862 gosub10340
9865 if(be=0)then:be=sz(((peek(53241)-v1)+1))
9884 goto9728
9887 if(tb<mi(li))then11014
9895 if(tb>ma(li))then11071
9903 s$="           "
9917 z=29
9920 gosub10472
9923 sys((ba+(18*3)))
9930 poke53248,150
9939 poke53249,150
9948 poke53264,(peek(53264)and254)
9965 de=peek(249)
9970 re(r2)=de
9975 r2=(r2+1)
9979 if(r2>20)then:r2=0
9986 if(r1=r2)then:r1=(r1+1):if(r1>20)then:r1=0
10002 poke53241,255
10011 j=int(((de-1)/3))
10020 k=(3-(de-(3*j)))
10031 x=(3+(2*j))
10038 y=(2+(3*k))
10045 if(de=0)then:x=1:y=3
10055 if(de=37)then:x=1:y=7
10066 x1=x(x,1)
10071 y1=y(1,y)
10076 if(x=1)then:y1=y(0,y)
10086 x1=((x1*2)+22)
10092 y1=(y1-5)
10096 poke53264,120
10105 gosub10948
10108 poke53288,1
10116 poke53276,252
10125 goto11541
10128 pokev5,0
10131 be=be(x,y)
10136 be(x,y)=0
10141 if(be=0)thenreturn
10145 k=0
10148 if(y>9)then9620
10154 if((x/2)>1)then:if((x/2)<5)then:if((x/2)=int((x/2)))then:ifbe((x+1),y)then:k=(kor2)
10192 if((x/2)>5)then:if((x/2)<9)then:if((x/2)=int((x/2)))then:ifbe((x+1),y)then:k=(kor2)
10230 if((x/2)>9)then:if((x/2)<13)then:if((x/2)=int((x/2)))then:ifbe((x+1),y)then:k=(kor2)
10268 if((x/2)<>int((x/2)))then:if((x>4)and(x<26))then:if(((x<>11)and(x<>19))andbe((x-1),y))then:k=(kor1)
10309 pokev5,k
10313 goto9620
10316 i=5
10318 fori=ito1step-1
10324 if(kand(2^(i+1)))then:be=sz(i)
10338 next
10339 return
10340 x8=(-(x<>1)-(x=27))
10349 y8=((1-(y=10))-(2*(y=11)))
10361 if(bu(x,y)<0)thenreturn
10368 if((y=10)or(y=11))then:if((x<3)or(x>25))thenreturn
10385 if(y=10)then:x=((int(((x-3)/8))*8)+3):return
10402 if(y=11)then:x=(((int(((x-3)/4))*4)+3)-(3*(x=22))):return
10425 if((y=4)or(y=6))then:if(x<>1)then:y=5:return
10442 if(x<>1)thenreturn
10446 if(y<5)then:if(y>1)then:y=2:return
10459 if(y>5)then:if(y<9)then:y=6
10471 return
10472 i=z
10475 fori=ito((z+len(s$))-1)
10485 a=asc(mid$(s$,((i-z)+1),1))
10496 if(a>64)then:if(a<91)then:a=(a-64)
10513 poke(v2+i),a
10518 next
10519 sys((ba+(15*3)))
10526 return
10527 gosub10610
10530 s$="bet on table: $      status:"
10561 z=0
10564 gosub10472
10567 s$=(str$(tb)+" ")
10573 l=(len(s$)-1)
10579 s$=right$(s$,l)
10584 if(l<4)then:s$=("0"+s$):l=(l+1):goto10584
10604 z=15
10607 goto10472
10610 i=0:fori=ito39:poke(v2+i),32:next:sys((ba+(15*3))):return
10632 mo=ub
10636 gosub10812
10639 i=1
10641 fori=ito9:poke(680+i),asc(mid$(m$,i,1)):next:poke690,255:return
10665 s$=""
10667 i=1
10669 fori=ito9:s$=(s$+chr$(peek((680+i)))):next
10684 ub=val(s$)
10688 li=peek(680)
10693 return
10694 m=(mo-tb)
10700 k=125
10704 ifflthen:fl=0:k=127
10715 if(tb=>(2*ma(li)))then10795
10725 if(m>499)then10801
10734 if(m>99)then:k=(kand63):goto10801
10751 if(m>49)then:k=(kand31):goto10801
10767 if(m>4)then:k=(kand15):goto10801
10782 ifmthen:k=(kand7):goto10801
10795 k=(kand3)
10801 poke2,k
10805 sys((ba+48))
10811 return
10812 m$=str$(mo)
10817 l=(len(m$)-1)
10824 m$=right$(m$,l)
10831 if(l<9)then:m$=("0"+m$):l=(l+1):goto10831
10853 return
10854 mo=ub
10858 gosub10812
10861 i=0:fori=ito8:poke(v3+i),val(mid$(m$,(i+1),1)):next:sys((ba+(12*3))):return
10888 sys((ba+6))
10893 sys(ba)
10896 gosub10610
10899 s$="please wait one moment ..."
10928 z=7
10931 goto10472
10934 poke163,x2
10938 poke164,y2
10942 sys((ba+24))
10947 return
10948 poke2,1
10951 sys((ba+48))
10957 poke53250,(x1and255)
10968 poke53251,(y1+49)
10979 poke53264,((peek(53264)and253)or(-2*(x1>255)))
11004 poke2,3
11007 sys((ba+48))
11013 return
11014 gosub10610
11017 s$=(("minimum bet is $"+right$(str$(mi(li)),2))+"  --  bet more!!")
11062 z=0
11065 gosub10472
11068 goto12833
11071 gosub10610
11074 s$="maximum bet is $"
11093 be=ma(li)
11097 gosub13758
11100 s$=(s$+" -- bet less!!")
11119 z=0
11122 gosub10472
11125 goto12833
11128 gosub11155
11131 x2=x(x,y)
11136 y2=y(x,y)
11141 x1=((x2*2)+22)
11147 y1=y2
11149 gosub10948
11152 goto10934
11155 poke53269,(peek(53269)and253)
11172 if(be=>sz(5))then:poke53241,(v1+4):return
11190 if(be=>sz(4))then:poke53241,(v1+3):return
11208 if(be=>sz(3))then:poke53241,(v1+2):return
11226 if(be=>sz(2))then:poke53241,(v1+1):return
11244 poke53241,v1
11252 return
11253 t$=right$((t$+a$),cl)
11261 if(t$=cd$)then:sys((ba+57))
11273 if(right$(t$,c2)<>c2$)then9359
11282 sys((ba+(13*3)))
11289 sys((ba+3))
11294 sys((ba+18))
11299 print"{clr}{blk}"
11303 k=peek(53269)
11312 poke53269,0
11320 printtab(13)
11322 print"{down}{down}{down}{down}{red}change max bet"
11344 print
11345 print"{pur}enter new upper limit:"
11371 print"{yel}==>{blu}C{left}";
11380 s$=""
11382 geta$
11384 if(a$<>chr$(13))then:if(a$<>chr$(20))then:if((a$<"0")or(a$>"9"))then11382
11408 if(a$=chr$(13))then11464
11415 if((a$=chr$(20))and(s$<>""))then:print" {left}{left}C{left}";:s$=left$(s$,(len(s$)-1))
11439 if((a$=chr$(20))or(len(s$)>3))then11382
11451 printa$;
11453 print"C{left}";
11457 s$=(s$+a$)
11461 goto11382
11464 print"{clr}"
11467 ma(li)=val(s$)
11472 sys((ba+42))
11478 gosub10801
11481 sys(ba)
11484 sys((ba+15))
11489 goto9359
11492 x8=(-(x<>1)-(x=27))
11501 y8=((1-(y=10))-(2*(y=11)))
11513 am=(am+(be*py))
11522 if(py<0)then:tb=(tb-be):be(x,y)=0:goto9620
11540 return
11541 if((de>0)and(de<37))then11723
11554 if(de=0)then11642
11561 x=1:forx=xto2:y=1:fory=yto5:l=(((6*(x=2))*(y<3))+((11*(x=2))*(y>1)))
11594 l=((l+((18*(x=1))*(y=2)))-(17*(x=1))):ifbe(x,y)then:py(x,y)=l
11626 next:next:ifbe(1,9)then:py(1,9)=17
11639 goto12165
11642 x=1:forx=xto2:y=5:fory=yto9:l=(((6*(x=2))*(y>7))+((11*(x=2))*(y<9)))
11675 l=((l+((18*(x=1))*(y=6)))-(17*(x=1))):ifbe(x,y)then:py(x,y)=l
11707 next:next:ifbe(1,1)then:py(1,1)=17
11720 goto12165
11723 de=(de-1)
11729 j=int((de/3))
11736 k=(2-(de-(3*j)))
11747 ifbe(((j*2)+3),(2+(k*3)))then:py(((j*2)+3),(2+(k*3)))=35
11779 if(j<>0)then11893
11786 ifbe(2,1)then:py(2,1)=6
11797 ifbe(2,9)then:py(2,9)=6
11808 ifbe(2,2)then:if(k=0)then:py(2,2)=17
11825 ifbe(2,5)then:if(k=1)then:py(2,5)=11
11842 ifbe(2,8)then:if(k=2)then:py(2,8)=17
11859 ifbe(2,3)then:if(k<2)then:py(2,3)=11
11876 ifbe(2,7)then:if(k>0)then:py(2,7)=11
11893 x=(((j*2)+2)-(j=0))
11905 forx=xto((j*2)+4):y=1:fory=yto9
11920 l=((5-(((y>1)and(y<9))*3))-(9*(y=((k*3)+2)))):if(x=((j*2)+3))then:l=((l*2)+1)
11962 if(((y=2)or(y=5))or(y=8))then:if(((y-2)/3)<>k)then:l=0
11988 if((y=3)or(y=7))then:if(k=(2-(int((y/4))*2)))then:l=0
12013 ifbe(x,y)then:py(x,y)=l
12025 next:next:ifbe(27,((k*3)+2))then:py(27,((k*3)+2))=2
12048 l=int((de/12))
12055 ifbe(((l*8)+3),10)then:py(((l*8)+3),10)=2
12076 l=int((de/18))
12083 ifbe(((l*20)+3),11)then:py(((l*20)+3),11)=1
12104 l=-((int((de/2))*2)<>de)
12117 ifbe((7+(l*12)),11)then:py((7+(l*12)),11)=1
12138 l=bl(de)
12144 ifbe((11+(l*4)),11)then:py((11+(l*4)),11)=1
12165 am=0
12168 y=1:fory=yto11:x=1:forx=xto27:if(y>9)then:x=(x+2)
12189 if(y>9)then:if(x>3)then:x=((x+1)-(4*(y=10)))
12209 py=py(x,y):be=be(x,y):ifpythen:if(be=0)then12250
12230 ifpythen:gosub11492:goto12250
12240 ifbethen:py=-1:gosub11492
12250 py(x,y)=0:next:next:am=int(am):if(am=0)then12283
12269 mo=(mo+am)
12276 ub=mo
12280 gosub10854
12283 if(am=0)then:s$="even       ":goto12359
12306 s$="won  $"
12314 if(am<0)then:s$="lost $"
12328 a$=str$(am)
12332 l=len(a$)
12336 s$=(s$+right$(a$,(l-1)))
12345 if(len(s$)<11)then:s$=(s$+" "):goto12345
12359 z=29
12362 gosub10472
12365 fl=1
12368 be=0
12370 gosub10694
12373 goto10567
12376 sys((ba+21))
12381 gosub9682
12384 gosub10340
12387 if(bu(x,y)<0)thenreturn
12394 s$="the house advantage is "
12420 k=((6*(x=2))*((y=1)or(y=9)))
12435 ifkthen:s$=(s$+"7.89%"):goto12460
12451 s$=(s$+"5.26%")
12460 gosub10610
12463 z=6
12466 gosub10472
12469 goto12833
12472 sys((ba+21))
12477 gosub9682
12480 gosub10340
12483 s$=""
12485 if(bu(x,y)<0)thenreturn
12492 k=(((((6*(x=2))*((y<3)or(y>7)))+((11*(x=2))*((y>1)and(y<9))))-(17*(x=1)))+((18*(x=1))*((y=2)or(y=6))))
12541 k=((k-(2*((x=27)or(y=10))))-(y=11))
12559 ifkthen12610
12564 k=((5-(3*((y>1)and(y<9))))-(9*(((y-2)/3)=int(((y-2)/3)))))
12592 if((x/2)<>int((x/2)))then:k=((k*2)+1)
12610 be=k
12613 gosub13758
12616 s$=(s$+":1, true odds ")
12635 if(k=1)then:s$=(s$+"1.1:1")
12650 if(k=2)then:s$=(s$+"2.2:1")
12665 if(k=5)then:s$=(s$+"5.3:1")
12680 if(k=6)then:s$=(s$+"6.6:1")
12695 if(k=8)then:s$=(s$+"8.5:1")
12710 if(k=11)then:s$=(s$+"11.7:1")
12726 if(k=17)then:s$=(s$+"18:1")
12740 if(k=35)then:s$=(s$+"37:1")
12755 gosub10610
12758 z=0
12761 gosub10472
12764 be=be(x,y)
12769 s$="no bet placed"
12785 ifbethen:s$="bet pays $"
12801 if(be=0)then:z=27:gosub10472:goto12833
12815 be=(be*k)
12820 gosub13758
12823 z=(40-len(s$))
12830 gosub10472
12833 poke198,0
12837 if((peek(56320)and31)=31)then:if(peek(198)=0)then12837
12858 geta$
12860 be=0
12862 a$=" "
12865 poke198,0
12869 goto10527
12872 gosub10610
12875 sys((ba+3))
12880 sys((ba+9))
12885 poke53269,0
12893 poke53280,0
12901 poke53281,0
12909 sys((ba+18))
12914 gosub10632
12917 print"{blk}{clr}"
12921 load"cml",8
12928 s$=("minimum bet: $"+right$(str$(mi(li)),2))
12952 gosub10610
12955 z=0
12958 gosub10472
12961 s$="maximum bet: $"
12978 be=ma(li)
12982 gosub13758
12985 z=(40-len(s$))
12992 gosub10472
12995 goto12837
12998 sys((ba+(13*3)))
13005 sys((ba+3))
13010 sys((ba+18))
13015 print"{clr}{blk}"
13019 k=peek(53269)
13028 poke53269,0
13036 printtab(14)
13038 print"{down}{down}{down}{down}{down}{down}help screen"
13058 print
13059 printtab(4)
13061 print"ctrl-h      show house advantage"
13096 printtab(4)
13098 print"ctrl-r      last twenty results"
13132 printtab(4)
13134 print"ctrl-v      show bet/chip value"
13168 printtab(4)
13170 print"ctrl-l      show table limits"
13202 printtab(4)
13204 print"ctrl-o      show odds"
13228 printtab(4)
13230 print"ctrl-s      spin wheel"
13255 printtab(4)
13257 print"ctrl-q      quit game"
13281 print
13282 printtab(4)
13284 print"   ?        show this menu"
13313 print"{down}{down}{down}{down}{down}{rght}hit any key or move joystick to return"
13360 gosub12837
13363 print"{clr}"
13366 sys((ba+42))
13372 gosub10801
13375 sys(ba)
13378 sys((ba+15))
13383 return
13384 k=(peek(53278)and124)
13396 if(k=0)then13434
13403 s$="chip value is: $"
13422 gosub10316
13425 gosub13758
13428 goto13477
13431 goto12837
13434 sys((ba+21))
13439 gosub9682
13442 gosub10340
13445 if(bu(x,y)<0)thenreturn
13452 s$="bet size is: $"
13469 be=be(x,y)
13474 gosub13758
13477 gosub10610
13480 z=int(((40-len(s$))/2))
13490 gosub10472
13493 goto12833
13496 sys((ba+(13*3)))
13503 sys((ba+3))
13508 sys((ba+18))
13513 print"{clr}{wht}"
13517 m=1
13520 k=peek(53269)
13529 poke53269,0
13537 i=(r2-1)
13541 print"{home}last twenty results"
13564 if(i<0)then:i=20
13571 print(right$(str$(m),2)+" -");
13581 o$=right$(str$(re(i)),2)
13589 if(re(i)=37)then:o$=" 0"
13602 if(re(i)=0)then:o$="00"
13614 print" ";
13617 printo$;
13620 if((re(i)=0)or(re(i)=37))then13666
13635 ifbl((re(i)-1))then:print" {blk}black{wht}";:goto13666
13658 print" {red}red{wht}";
13666 print
13667 i=(i-1)
13671 m=(m+1)
13677 if(i<0)then:i=20
13684 if(i<>r2)then13571
13690 print"{down}{down}{rght}hit any key or move joystick to return"
13734 gosub12833
13737 print"{clr}"
13740 gosub10801
13743 sys((ba+42))
13749 sys(ba)
13752 sys((ba+15))
13757 return
13758 o$=str$(int(be))
13763 l=(len(o$)-1)
13770 o$=right$(o$,l)
13777 s$=(s$+o$)
13782 return
13783 end
